import math

#ASIDE
#wordSet = [['AAACAGAAAAA', 29], ['AAACAAAAAAA', 29], ['AAAAAGAAAAA', 29], ['AAAAAAAAAAA', 29], ['ATACAGAAAAA', 29], ['ATACAAAAAAA', 29], ['ATAAAGAAAAA', 29], ['ATAAAAAAAAA', 29], ['AAACAGATAAA', 29], ['AAACAGAGAAA', 29], ['AAACAAATAAA', 29], ['AAAAAGATAAA', 29], ['AAACAAAGAAA', 29], ['AAAAAGAGAAA', 29], ['AAACACAAAAA', 29], ['AAAAAAATAAA', 29], ['AAAAAAAGAAA', 29], ['AAAAACAAAAA', 29], ['AATCAGAAAAA', 29], ['AAACATAAAAA', 29], ['AAACAGACAAA', 29], ['CAACAGAAAAA', 29], ['AATCAAAAAAA', 29], ['AATAAGAAAAA', 29], ['AAACCGAAAAA', 29], ['AAAAATAAAAA', 29], ['AAACAAACAAA', 29], ['ACAAAACAACA', 12], ['ACACAACAACA', 12], ['ACAAAACAAAA', 12], ['ACACAACAAAA', 12], ['AAAAAACAACA', 12], ['AAACAACAACA', 12], ['AGAAAACAACA', 12], ['AGACAACAACA', 12], ['AAAAAACAAAA', 12], ['AAACAACAAAA', 12], ['ACAATACAACA', 12], ['ACACTACAACA', 12], ['ATAAAACAACA', 12], ['ATACAACAACA', 12], ['AGAAAACAAAA', 12], ['ACAAAACCACA', 12], ['AGACAACAAAA', 12], ['ACACAACCACA', 12], ['TAAAAAGCAAC', 145], ['AAAAAAGCAAC', 145], ['CAAAAAGCAAC', 145], ['TCAAAAGCAAC', 145], ['TAAAAAACAAC', 145], ['GAAAAAGCAAC', 145], ['ACAAAAGCAAC', 145], ['TAAAAACCAAC', 145], ['TAAAAAGAAAC', 145], ['TTAAAAGCAAC', 145], ['CCAAAAGCAAC', 145], ['TAAAAAGCAAT', 145], ['TAGAAAGCAAC', 145], ['AGCAAAAAAAA', 69], ['AGCTAAAAAAA', 69], ['AGAAAAAAAAA', 69], ['AGCAGAAAAAA', 69], ['AGATAAAAAAA', 69], ['AGCTGAAAAAA', 69], ['AGCAAAAAACA', 69], ['AGCCAAAAAAA', 69], ['AGCTAAAAACA', 69], ['AGAAGAAAAAA', 69], ['AGATGAAAAAA', 69], ['AGAAAAAAACA', 69], ['AGACAAAAAAA', 69], ['AGCAGAAAACA', 69], ['AGCCGAAAAAA', 69], ['AGATAAAAACA', 69], ['AGCTGAAAACA', 69], ['ACACAAAAACG', 44], ['ACACAAAAGCG', 44], ['ATACAAAAACG', 44], ['ATACAAAAGCG', 44], ['ACACAGAAACG', 44], ['ACAAAAAAACG', 44], ['ACACAGAAGCG', 44], ['ACACAAAAACA', 44], ['ACAAAAAAGCG', 44], ['ACACACAAACG', 44], ['ACACAAAAAGG', 44], ['ACACAAAAGCA', 44], ['ATACAGAAACG', 44], ['ACACACAAGCG', 44], ['ACACAAAAAAG', 44], ['ACCAACAAGCA', 111], ['ACCAACACGCA', 111], ['ACCAACAGGCA', 111], ['ACAAACAAGCA', 111], ['ACAAACACGCA', 111], ['ACAAACAGGCA', 111], ['AACAACAAGCA', 111], ['ACCAACGAGCA', 111], ['AACAACACGCA', 111], ['AACAACAGGCA', 111]]
#setProb = prob.locationSpecificProbability(wordSet) 
#print 'near 99 set'
#print setProb

#Index 29,12,69,146,37


window2 = [
[0,0.043659697663800005, 0.0831467803730788, 0.12260882273557623, 0.15829942560333268, 0.17306973944047943, 0.18642843488130936, 0.19977865903625455, 0.21185298464091448, 0.2211558868621954, 0.22987079439824337, 0.23828460597057205, 0.24669308200669324, 0.254575094322252, 0.26245210833689375, 0.27021570976249343, 0.27782057664118925, 0.2849447740255473, 0.29196194511779194, 0.2985640041964118, 0.3048245649568128, 0.31092407341543254, 0.31690686791099226, 0.32287795948603, 0.32884526455182356, 0.3345455511203351, 0.34020419117419826, 0.3457207615555631, 0.3512338336578474, 0.35664484458371243, 0.36205242416999184, 0.3674494260113459, 0.37260492866577766, 0.37775716200869175, 0.3827433425306338, 0.3876341125956191, 0.3922939401948798, 0.39683962446243115, 0.40095087168235627, 0.40505951179512056, 0.40911923786512916, 0.41283520981721855, 0.4165069425062051, 0.4201763468018663, 0.4238425158145273, 0.4273780078085483, 0.4306967222905474, 0.43401251068981456, 0.4373261964143417, 0.44052379677018777, 0.4437193693990841, 0.44686659195803774, 0.44986358436244117, 0.4528118851124913, 0.4557020526457713, 0.4585484909891351, 0.4613931242915002, 0.46405965204589616, 0.4667244888478314, 0.469350957552348, 0.4719237254939179, 0.4743338803240095, 0.47670782757576396, 0.47894134016931206, 0.48105932201929447, 0.48312281899721427, 0.48514683100487965, 0.4871668838507054, 0.48918565569980244, 0.4911140937349654, 0.4930284425270851, 0.4948947283741588, 0.49675983073434016, 0.4986147737548298, 0.5004453482623927, 0.5022747619290595, 0.5041005970869276, 0.505903824628202, 0.507655030638492, 0.5093991653043016, 0.5111421939441941, 0.5128290460091093, 0.5145067096758416, 0.5161833094685899, 0.5178378836555535, 0.5194921329704139, 0.5211230236745654, 0.5227528801653492, 0.5243367211049221, 0.5259195576672747, 0.5274960027585367, 0.5290532054427366, 0.5306028970849426, 0.532140726864556, 0.5336570918013088, 0.5351522935556553, 0.5366263825095327, 0.5380579452916248, 0.5394663240591464, 0.5408738097170657, 0.5422805604128783, 0.5436812571768471],
[0,0.02317844812891848, 0.04572871287779788, 0.06225099274566932, 0.0783254850155263, 0.08815501537768611, 0.09771814535045166, 0.10587530521744919, 0.11381138935805343, 0.12081816784080779, 0.12763504828698954, 0.13405291008632025, 0.14029683469644383, 0.14646081262246222, 0.1524577341318251, 0.15827239771499013, 0.16408192304074526, 0.16973899734083378, 0.17539107264080386, 0.18068857389586204, 0.1859302676917843, 0.19108419582125383, 0.1961838289879425, 0.20075866972844772, 0.20520952292226616, 0.20960338776716894, 0.21387816988253117, 0.2180193704839578, 0.22204833607393093, 0.2258900627702638, 0.22966627754744162, 0.23340388558803593, 0.2371403191661693, 0.24081419079469077, 0.24444935937607593, 0.2479792158416834, 0.25141340597306155, 0.25477174281611625, 0.2580390618577355, 0.26089693530133407, 0.2636773545258435, 0.2664158503604068, 0.26913754109076937, 0.2718018180837601, 0.2744497454252663, 0.27699717494708387, 0.2795142644239814, 0.28200869221692504, 0.2844870811852713, 0.2869507882143885, 0.28939965941512436, 0.2917965949416644, 0.2941905162647363, 0.29651955742068437, 0.29877818683410573, 0.30102475438429505, 0.30324765507331397, 0.3054450710072441, 0.3076307519791209, 0.3097934075102003, 0.3118379458921479, 0.31387512217761204, 0.3158642493851683, 0.3178462140241227, 0.3197863152643234, 0.3216738357904094, 0.3235381782344239, 0.32538288043490643, 0.3271987631579018, 0.3290125781062221, 0.33080728510180485, 0.33260154054800484, 0.334379642079047, 0.3361463106639629, 0.33790251353057027, 0.33964814098215307, 0.3413567471569266, 0.3430634860310428, 0.34472396878875194, 0.3463562973680846, 0.3479854991591057, 0.34959551666669697, 0.3512041114463401, 0.352805530902891, 0.3543936200370893, 0.3559786671253384, 0.35756321614683356, 0.35912959888499524, 0.3606945974540479, 0.36225261516594875, 0.3637975756253128, 0.365339180125474, 0.36684226899455763, 0.3683403235742178, 0.36983726724834864, 0.37129472148306336, 0.3727521286036461, 0.3742085020406449, 0.3756598704061856, 0.3770840759345954, 0.3785019843395606, 0.379914017652104],
[0,0.01190686314970317, 0.023183506642402017, 0.032647842448626535, 0.04203531062693941, 0.05099870757205665, 0.05988930542431536, 0.06789373137579977, 0.07586292161751161, 0.08344368043565983, 0.09090544010256375, 0.09797225547903615, 0.10433468479298985, 0.11066910651288077, 0.11697986132382313, 0.12326283601332869, 0.12928850761288352, 0.13526523979482727, 0.14062255283194441, 0.1456387440798462, 0.15063285391178563, 0.1554287537023817, 0.16017944241716675, 0.16443777720819064, 0.16866152657230857, 0.1728129876155427, 0.1767447155248826, 0.18055680318731068, 0.18433792976150168, 0.1876952356984844, 0.19099508225803827, 0.1942681280591767, 0.19749218667662397, 0.20071126799421446, 0.20383645661567146, 0.20693626301897533, 0.20998496123076088, 0.2129904422860189, 0.2157812749422142, 0.21856265821065846, 0.22134120554244777, 0.22411703656647988, 0.22676015293693053, 0.229394320067304, 0.2320232288286148, 0.23462485481370052, 0.2371875426543879, 0.23974627421904687, 0.24228814837143908, 0.24475207261129098, 0.2471753727941686, 0.24939370495311913, 0.2516045261347691, 0.2538130931327192, 0.25601950103566307, 0.2582198574761639, 0.26042017274153945, 0.2626130380324169, 0.264803667447668, 0.2669921553036928, 0.2691561927764089, 0.27131070409487135, 0.27343362966907875, 0.2755345474834821, 0.2776283518699208, 0.2797179765685629, 0.28180187010327695, 0.28388572464222844, 0.2859625235271938, 0.2880351766710328, 0.29008467356856527, 0.29210511759760427, 0.2941156786127837, 0.295985472204517, 0.297853359328974, 0.29971492203635247, 0.30157276866070953, 0.30334359574369607, 0.30509257966871983, 0.3068415308651225, 0.30858456034566173, 0.3103258126093569, 0.3120653626249107, 0.31380014161803804, 0.31552025690629926, 0.3172328001983374, 0.31892023712217754, 0.3205939689877609, 0.32226611310309916, 0.3239225248673887, 0.3255789056353539, 0.3272296781185998, 0.3288771553018417, 0.3305201139886229, 0.3321600980247654, 0.3337891691435131, 0.3353872915345507, 0.3369724342638533, 0.3385256154062567, 0.340011846852608, 0.34149656291692465, 0.34297625193035],
[0,0.027857308894229146, 0.044646741009299364, 0.05943652188123888, 0.06996299931628747, 0.07953005238356584, 0.08861481628034222, 0.09752852804227168, 0.10630497690609289, 0.11477713503570536, 0.12264555212283344, 0.12951882374679652, 0.13586306823134464, 0.14199937692002856, 0.14758801059634308, 0.1530633430236604, 0.15835285583948866, 0.16345897446441926, 0.16853823818628494, 0.17336144877768792, 0.17810369631634956, 0.18276321874267365, 0.18701198136633765, 0.19120795541886937, 0.19538539283644263, 0.19952787220432128, 0.2033800348392521, 0.20707835108928718, 0.21072745379255628, 0.21434256854089725, 0.21771080436298398, 0.22102717247577072, 0.22428501267895753, 0.22748639805742832, 0.23060638422099344, 0.23372184288543552, 0.23673594422383962, 0.2397091931917025, 0.24261879177238835, 0.24552571171603815, 0.2483878677872753, 0.25119613386073014, 0.25395905531146756, 0.2566613107272313, 0.25933046527023007, 0.2619527948565003, 0.26455000691777, 0.26711603767649583, 0.26967674129341385, 0.27220562955677985, 0.27472334590201625, 0.2772022917494632, 0.27963464138836047, 0.2820276390050722, 0.28438813099020777, 0.28670980618507125, 0.2890285411063509, 0.2912842603655036, 0.2935257564891673, 0.2957534496599941, 0.2979527418583208, 0.30013803973250613, 0.3023034648697261, 0.3044108612117325, 0.30650120828319916, 0.3085463678307354, 0.31054752723368045, 0.3125462823004253, 0.31450976294892696, 0.31645114817374553, 0.31838439304041005, 0.3203138487064291, 0.32223315667540364, 0.3240993734639684, 0.32589133269077936, 0.3276520324721198, 0.32940753872159373, 0.33114076558572686, 0.3328668408721279, 0.33459184507993667, 0.3362570411802691, 0.3379134794190744, 0.3395675139540552, 0.34118944859274764, 0.34279813194311937, 0.3444036173851874, 0.3460038400947848, 0.347589378251027, 0.34916984048229244, 0.350748374176246, 0.35231369822663056, 0.3538602294939683, 0.3553797826308349, 0.35689380240015106, 0.35838784811650765, 0.3598538105789062, 0.36131296579182354, 0.3627552110277095, 0.3641962370285308, 0.36563089698118106, 0.36702838453826997, 0.36842061090522443],
[0,0.032251005931265044, 0.05416576841450259, 0.07291416915833768, 0.08923537506094198, 0.10554582568524541, 0.11849827243017488, 0.13123792929909114, 0.14367166935886705, 0.15571413918612212, 0.1667971935314029, 0.1762851614272517, 0.18576687698268898, 0.19456814645617043, 0.20301695145682785, 0.211271150521839, 0.21945408492513493, 0.22698370005418447, 0.23432823219630872, 0.2415563087990099, 0.24855692920595499, 0.2553442556464371, 0.2618990760051278, 0.26844957689639737, 0.2748924625779751, 0.2811847820202761, 0.2874729549768845, 0.29356726502865227, 0.29965755907810687, 0.30477398017501744, 0.30976754088155095, 0.31475819691839485, 0.3196697206797447, 0.32454022470566846, 0.32937664591520754, 0.3341750398698034, 0.33893200570772103, 0.3436882939991315, 0.3483003252379825, 0.3527514320184766, 0.3570242853084262, 0.3612938647494518, 0.365432258070619, 0.3693779184434022, 0.3731884166074128, 0.376996403745678, 0.38071323731066453, 0.3844276215726015, 0.38809998155037034, 0.39175788067959155, 0.39541336934212507, 0.39895616014223956, 0.40249661632925965, 0.40593146585300455, 0.4093640518943346, 0.41275720797332754, 0.4160722076368872, 0.41935858643393403, 0.4225905144063579, 0.4257727582655022, 0.4288548619183434, 0.4318045268571683, 0.434707421652583, 0.4376086278832601, 0.4404399864305592, 0.44325153169509063, 0.4459774151744512, 0.4486585163498177, 0.451275236362882, 0.4538627877047583, 0.45639716365698246, 0.4589242455300932, 0.46144966211762417, 0.46397360971309787, 0.4664690015417209, 0.4689529292049486, 0.47141611176736564, 0.47386367035083565, 0.4763096160526424, 0.4787166219209772, 0.4811223842896368, 0.4835278039995627, 0.48586026792206316, 0.48802096595805683, 0.4901802401465211, 0.49231508445759686, 0.4943194004369883, 0.4963161733594574, 0.49831163045706567, 0.500284165828239, 0.5022402271105193, 0.5041673279981801, 0.5060777907854306, 0.507987981460702, 0.5098677129168206, 0.5117454398053244, 0.5136039041110081, 0.5154561591735163, 0.5173060854444363, 0.5191397787063083, 0.5209584164846374, 0.5227501284870678],
]


if 0:
	#Transform
	for i in range(len(window2)):
		for j in range(len(window2[i])):
			score = window2[i][j]
			score = 1 - score
			#Base 
			score = math.log10(score)
			window2[i][j] = score

	#print window2

	wordProb = []
	for i in window2:
		row = []
		row.append(i[0])
		for j in range(1,len(i)):
			row.append(i[j]-i[j-1])
		wordProb.append(row)

	print wordProb


	#full = wordProb[0] + wordProb[1] + wordProb[2] + wordProb[3] + wordProb[4]
	#full.sort()
	#print full[0:100]
	#print sum(full[0:100])

	#print wordProb[4]
	count = [0,0,0,0,0]
	total = 0
	for i in range(100):
		minScores = [wordProb[0][1],wordProb[1][1],wordProb[2][1],wordProb[3][1],wordProb[4][1]]
		index = minScores.index(min(minScores))
		#print minScores[index]
		#print index
		total += minScores[index]
		del wordProb[index][0]
		count[index] = count[index]+1

	print total 
	print count 
	print 1-(10**total)








if 1:
	count = 0
	limit = 100
	maxprob = 0
	setup = []

	for a in range(0,limit+1):
		print a
		for b in range(0,limit+1):
			if (a+b) > limit:
				break
			for c in range(0,limit+1):
				if (a+b+c) > limit:
					break
				for d in range(0,limit+1):
					if (a+b+c+d) > limit:
						break
					for e in range(0,limit+1):
						if (a+b+c+d+e) > limit:
							break

						if (a+b+c+d+e) == limit:
							count += 1
							prob = 1-((1-window2[0][a])*(1-window2[1][b])*(1-window2[2][c])*(1-window2[3][d])*(1-window2[4][e]))

							if prob > maxprob:
								maxprob = prob
								setup = [a,b,c,d,e]

	print maxprob
	print setup
	print count

	print (math.log10(1-window2[0][setup[0]]) + math.log10(1-window2[1][setup[1]]) + math.log10(1-window2[2][setup[2]]) + math.log10(1-window2[3][setup[3]]) + math.log10(1-window2[4][setup[4]]))
